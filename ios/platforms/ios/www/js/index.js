var e=ENDPOINT+"/query";var a=1e3;var r=1e3;var i=30;var t="query.xml";var n="prezzo discrezionale";var o={dati:null,nascondiPrezzoND:false,nascondiRimborsoND:false,encoding:"base64",ricercaIniziale:"",query:null};function msgbox(e,a,r){if(r){setTimeout("msgbox ('"+e+"', '"+a+"')",r);return}var i=$.mobile.activePage.attr("id");if(i=="search"){i=""}try{$("#popupDialog"+i+"Title").html(a?a:"Avviso");$("#popupDialog"+i+"Message").html(e);$("#popupDialog"+i).popup("open",{allowSamePageTransition:true,transition:"pop"})}catch(t){alert(t)}}function s(e){try{if(!e||e.length==0)return n;if(e.indexOf("0.00")==0)return n;if(e.indexOf("99999")==0)return n;var a=e.indexOf(".")<0?",":".";var r=e.split(a);if(r&&r.length>0){e=r[0];e+=a;e+=r[1].length>2?r[1].substr(0,2):r[1]}return"&euro; "+e}catch(i){return n}}function l(e,a){var r="";if(!a)a="'";for(var i=0;e!=null&&i<e.length;i++){var t=e.charAt(i);if(t==a)r+="\\";r+=t}return r}function c(e){var a=e.replace(/gtt /i,"gocce ").replace(/bust /i,"bustine ").replace(/polv /i,"polvere ").replace(/cpr /i,"compresse ").replace(/cps /i,"capsule ").replace(/grat /i,"granulato ").replace(/ riv/i," rivestite").replace(/ mast/i," masticabili").replace(/ eff/i," effervescenti").replace(/\*/g,"<br/>");var r=a.indexOf("(");var i=a.indexOf(")");if(r>0&&i>0&&r<i){a=a.substr(0,r).trim()+a.substr(i+1).trim()}return a}function u(e){if(e==null)return"";return e.toUpperCase()}function f(e){var a=e.split(" ");var r=0;var i=0;for(r=0;r<a.length;r++){if(!isNaN(a[r]))i++;if(i==2)break}var t="";for(var n=0;n<r;n++){t+=a[n];t+=" "}return t}function p(e,a){var r=0;var i=e.replace(/\?/gi,function s(e){if(r>a.length||typeof a[r]=="undefined")return e;var i=a[r++];if(i.indexOf&&i.indexOf("text:")==0){i="'"+l(i.substring(5,i.length),"'")+"'"}return i});console.log("SQL > "+i);switch(o.encoding){case"base64":return Base64.encode(i);case"xor":var t="";for(var n=0;n<a.length;n++){if(t.length>0)t+=";";t+=a[n]}return{data:i,params:t};default:return i}}function d(){var e="";var a=u(o.formaSelezionata).toUpperCase();$("#resultsHeader").html("");$("#resultsList").empty();e+='<ul data-role="listview" data-autodividers="false" data-inset="true">';e+='<li data-role="list-divider" style="color: #808080; height: 50px;">';e+='<span class="x-scrolling">';e+="ELENCO DEI FARMACI EQUIVALENTI<br/>";e+=o.ricercaIniziale+"<br>";var r="";for(var i=0;i<k.length;i++){if(!k||!k[i]||k[i].length==0)continue;if(r.length>0)r+=" &gt; ";r+=k[i]}e+=r;e+="</span>";e+="</li>";var t=0;var l=o.dati;var f="";for(var i=0;l!=null&&i<l.length;i++){var p=l[i];var d=c(p.descrizione);var h=s(p.prezzoAlPubblico);var v=s(p.prezzoRimborsoNazionale);if(h==n&&o.nascondiPrezzoND)continue;if(v==n&&o.nascondiRimborsoND)continue;var g="[["+p.descrizione+","+p.ditta+"]]";if(f.indexOf(g)>=0)continue;f+=g;if(p.descrizione.indexOf(k[D])<0){console.log("ignora posologia non selezionata ("+k[D-2]+"): "+p.descrizione);continue}var S=p.brand!="S"?"color: darkGreen;":"color: red;";e+='<li data-role="list-divider" style="background: white">';e+='<span class="x-scrolling" style=" '+S+'">';e+=d;e+='<br/><span style="font-size: smaller;">';e+=p.ditta;e+="</span>";if(p.classe=="CN")p.classe="C";if(h!=n){e+="<br/>Prezzo "+(p.classe=="C"?"massimo":"")+' <span color="'+(h==n?"darkRed":"darkBlue")+'">';e+=h;e+="</span>"}else{e+="<br/><i>Prezzo discrezionale</i>"}if(p.tipoRicetta&&p.classe=="C"&&(p.tipoRicetta!="C"&&p.tipoRicetta!="D"&&p.tipoRicetta!="h")){e+="<br/><b>Con obbligo di ricetta</b>"}if(v!=n){var E=parseFloat(p.prezzoAlPubblico);E-=parseFloat(p.prezzoRimborsoNazionale);E*=100;E=Math.round(E);var I=""+E;var m=I.substr(0,I.length-2);if(m.length==0)m="0";var O=I.substr(I.length-2,I.length);if(p.classe=="C"){e+="<br/><b><u>Costo a carico del cittadino</u></b>"}else if(p.classe=="A"){e+="<br/><b>Costo a carico del cittadino "+m+(O!="0"&&O!="00"?"."+O:"")+" &euro;</b>"}}if(p.inListaDiTrasparenza=="CN"){e+='&nbsp;<img src="images/inlista.png" style="border: 0px; width: 16px;" ';e+='alt="in lista di trasparenza"/>&nbsp;in lista di trasparenza'}e+="<br/><span>Classe "+p.classe+"</span>";e+="</span>";e+="</li>";t++}$("#resultsList").append(e);$("#resultsList ul").each(function(e){$(this).listview().listview("refresh")});return t}function h(a){$.ajax({url:e,dataType:"json",crossDomain:true,data:{sql:b(U!=null?"cercaDettagli":"cercaDettagliSenzaUPS",U!=null?[r,a,U]:[r,a]),encoding:o.encoding},method:"POST",success:function(e){o.dati=e;if(d()<=0){$("#resultsHeader").html($("#resultsHeader").html()+'<br><br><b style="color: red; font-weight: bolder;">IL FARMACO NON HA EQUIVALENTI</b>')}$.mobile.changePage("#results",{allowSamePageTransition:true,transition:"slide"})},error:function(e){msgbox("La ricerca della lista dei farmaci ha causato un errore","Avviso",200)}})}function v(e,a,r){var i=0;var t="0123456789BCDFGHJKLMNPQRSTUVWXYZ";for(var n=e.length-1;n>=0;n--){var o=t.indexOf(e.substr(n,1));i+=o*Math.pow(32,e.length-(n+1))}var s=""+i;if(a&&a>0){while(s.length<a){s="0"+s}}return r?r+s:s}function g(){$("#resultsList").html("");if(typeof cordova=="undefined"){msgbox("Funzione non disponibile in questa versione");return}cordova.plugins.barcodeScanner.scan(function(e){if(e.cancelled){return}if(e.format=="CODE_39"){var a=v(e.text,9);if(a.indexOf("A")>=0)a=a.substr(1);U=null;R(a)}else{msgbox("Il codice a barre non &egrave; valido<br/>provare con un altro codice a barre riportato sulla scatola")}},function(e){msgbox("Scansione fallita<br/>codice di errore:"+e)})}function OnClickAutocomplete(e,a,r){$(r).html("");$(r).listview("refresh");$(r).listview().listview("refresh");if(r=="#autocomplete1"){$("#autocomplete2div").hide()}else if(r=="#autocomplete2"){$("#autocomplete1div").hide()}S=r;$("#search").find("input").val(e);var i=E();o.ricercaIniziale=i;if(k){for(var t=0;t<k.length;t++){k[t]=""}}switch(a){case"C":w("tabellaOrdinataDosaggiPerPA",i);break;case"D":w("tabellaOrdinataDosaggiPerNF",i);break;default:console.log("ERROR: OnClickAutocomplete invoked with invalid type: "+a);break}}var S=null;function E(){var e="";var a=0;$("#search .ui-input-search").find("input").each(function(a){e=$(this).val()});return e}function I(e,a){var r="";$("#search .ui-input-search "+a).find("input").each(function(a){$(this).textinput(e?"enable":"disable")});return r}function m(){$("#search .ui-input-search").find("input").each(function(e){$(this).val("")})}function O(e){var a=0;var r="";var i=e.split(" ");var t=false;for(var n=0;n<i.length;n++){if(a==3&&r.length>0)break;var o=i[n].replace(/\,/g,".").toUpperCase();if(n==0&&!isNaN(o))continue;if(i[n]=="+"&&t){r+=" +";t=false;a=0}else if(!isNaN(o)){r+=" ";r+=i[n];t=false;a=0}else if(o.indexOf("CPR")>=0||o.indexOf("CPS")>=0||o.indexOf("BUST")>=0||o.indexOf("GRAT")>=0||o.indexOf("BOMB")>=0){r="";t=true;a=0}else{if(r.length>0){r+=" ";r+=i[n]}t=true}a++}if(r.trim().length==0)return e;var s=r.trim();return s.replace(/litro litri/i,"litri").replace(/litri litri/i,"litri").replace(/litri \(litri/i,"litri").replace(/litri con/i,"litri").replace(/ con/i,"")}function R(a){var r="";if(a.indexOf(",")>0){var i=a.split(",");var t="";for(var n=0;n<i.length;n++){if(!i[n])continue;if(i[n].length==0)continue;if(t.length>0)t+=", ";t+="'"+i[n]+"'"}r=b("cercaGruppoPerAIC_in",[t])}else{r=b("cercaGruppoPerAIC",["text:"+a])}$.ajax({url:e,dataType:"json",crossDomain:true,data:{sql:r,encoding:o.encoding},method:"POST",success:function(e){if(!e||e.length<=0){msgbox("Codice farmaco non trovato","Avviso",200);return}var a="";for(var r=0;r<e.length;r++){o.formaSelezionata=e[r].dosaggio;dosaggioSelezionato="";switch(e[r].classe){case"A":case"H":if(a.length>0)a+=" OR ";a+="APP_CA.FDI_1010 = '"+e[r].codeA+"'";break;case"C":case"CN":if(a.length>0)a+=" OR ";a+="APP_CA.FDI_1094 = '"+e[r].codeC+"'";break;default:console.log("warning: trovata classe non valida: "+e[r].classe)}if(B!=2)break}if(a.length==0){msgbox("Il prodotto non ha farmaci equivalenti","Avviso",200);console.log("la ricerca non ha prodotto gruppi di equivalenza validi");return}h(a)},error:function(e){msgbox("La ricerca dei farmaci equivalenti ha causato un errore:<br/>"+e)}})}function C(e){switch(e.toUpperCase()){case"COMPRESSE DELITESCENTI":case"COMPRESSE DISPERSIBILI":case"COMPRESSE DIVISIBILI":case"COMPRESSE DIVISIBILI RM":case"COMPRESSE DIVISIBILI RP":case"COMPRESSE DIVISIBILI RILASCIO MODIFICATO":case"COMPRESSE DIVISIBILI RILASCIO PROLUNGATO":case"COMPRESSE EFFERVESCENTI SOLUB":case"COMPRESSE EFFERVESCENTI SOLUB.":case"COMPRESSE EFFERVESCENTI SOLUBILI":case"COMPRESSE GASTRORESISTENTI":case"COMPRESSE GASTRORESISTENTI RM":case"COMPRESSE GASTRORESISTENTI RP":case"COMPRESSE GASTRORESISTENTI RILASCIO MODIFICATO":case"COMPRESSE GASTRORESISTENTI RILASCIO PROLUNGATO":case"COMPRESSE MUCOADESIVE":case"COMPRESSE ORODISPERSIBILI":case"COMPRESSE ORODISPERS/SUBLING":case"COMPRESSE ORODISPERS./SUBLING.":case"COMPRESSE ORODISPERSIBILI/COMPRESSE SUBLINGUALI":case"COMPRESSE RC":case"COMPRESSE RILASCIO CONTROLLATO":case"COMPRESSE RIVESTITE":case"COMPRESSE RIVESTITE DIVISIBILI":case"COMPRESSE RIVESTITE GASTRORES":case"COMPRESSE RIVESTITE GASTRORESISTENTI":case"COMPRESSE RIVESTITE MASTICAB":case"COMPRESSE RIVESTITE MASTICABILI":case"COMPRESSE RIVESTITE RM":case"COMPRESSE RIVESTITE RP":case"COMPRESSE RIVESTITE RILASCIO MODIFICATO":case"COMPRESSE RIVESTITE RILASCIO PROLUNGATO":case"COMPRESSE RM":case"COMPRESSE RILASCIO MODIFICATO":case"COMPRESSE RP":case"COMPRESSE RILASCIO PROLUNGATO":case"COMPRESSE SOLUBILI":case"COMPRESSE SOLUB E MASTICABILI":case"COMPRESSE SOLUBILI E MASTICABILI":case"COMPRESSE SOLUZIONE CUTANEA":case"COMPRESSE PER SOLUZIONE CUTANEA":case"COMPRESSE SUBLINGUALI":return"COMPRESSE";case"COMPRESSE RIVESTITE MASTICAB":case"COMPRESSE RIVESTITE MASTICABILI":return"COMPRESSE MASTICABILI"}return e}function b(e,a){var r=null;o.query.find("query").each(function(){var a=$(this).attr("name");if(a.toLowerCase().trim()==e.toLowerCase().trim()){return $(this).find("sql").each(function(){r={sql:$(this).text().trim(),encoding:$(this).attr("encoding")}})}});return p(r.sql,a)}var T=false;function P(){if("onhashchange"in window){window.location.hash="no-back-button";window.location.hash="Again-No-back-button";window.onhashchange=function(){if(T){T=false;goback();return}var e=window.location.hash;if(e=="#no-back-button"){return}else if(e=="#results"){setTimeout(function(){T=true},1e3)}else if(e=="#search"){}window.location.hash="no-back-button"}}else{console.log("warning: cannot detect back/forward pressed...")}$("#cerca3").on("click",function(){g()});$("#resultsMenu :input").change(function(){switch(this.name){case"choice-1":o.nascondiPrezzoND=this.checked;d();break;case"choice-2":o.nascondiRimborsoND=this.checked;d();break}});$("#searchclickProducts").on("click",function(){$("#cerca0").html("");$("#menuforma").hide();$("#menucerca").hide();$("#menucerca").slideToggle("slow",function(){});setTimeout(function(){$.mobile.changePage("#search",{reverse:true,allowSamePageTransition:true,transition:"slide"})},200)});$("#searchclick").on("click",function(){$("#menuforma").hide();$("#menucerca").hide();$("#menucerca").slideToggle("slow",function(){});m();$("#autocomplete1div").show();$("#autocomplete2div").show();$("#cerca0").html("");setTimeout(function(){$.mobile.changePage("#search",{reverse:true,allowSamePageTransition:true,transition:"slide"})},200)});if(typeof cordova=="undefined"){}$("#autocomplete1").on("filterablebeforefilter",function(r,i){var t=$(this),n=$(i.input),s=n.val(),l="";t.html("");if(s&&s.length>2){t.html("<li><div class='ui-loader'><span class='ui-icon ui-icon-loading'></span></div></li>");t.listview("refresh");var c="";var u=s.split(" ");for(var f=0;f<u.length;f++){var p=u[f];if(p.length==0)continue;c+=c.length>0?"%"+p:p}var d=c;if(c.length<=2)return;var h=b("autocompletaPrincipioAttivo",[a,"text:"+c+"%"]);$.ajax({url:e,dataType:"jsonp",crossDomain:true,data:{sql:h,encoding:o.encoding}}).then(function(e){var a="|";$.each(e,function(e,r){var i=null;var t=r.split("|");if(t[0]=="A"||t[0]=="C"){i=t[1];if(a.indexOf("|"+i+"|")>=0)return;a+=i+"|";i='<span style="color: #007700;">'+i+"</span>"}else if(t[0]=="B"||t[0]=="D"){i=t[1].replace(/\(/gi,'<i style="font-size: smaller;">').replace(/\)/gi,"</i>");if(a.indexOf("|"+i+"|")>=0)return;a+=i+"|";i='<span style="color: #000077;">'+i+"</span>"}l+="<li><a href=\"javascript:OnClickAutocomplete('"+t[1]+"', '"+t[0]+"', '#autocomplete1')\">"+i+"</a></li>"});t.html(l);t.listview("refresh");t.trigger("updatelayout")})}});$("#autocomplete2").on("filterablebeforefilter",function(r,i){var t=$(this),n=$(i.input),s=n.val(),l="";t.html("");if(s&&s.length>2){t.html("<li><div class='ui-loader'><span class='ui-icon ui-icon-loading'></span></div></li>");t.listview("refresh");var c="";var u=s.split(" ");for(var f=0;f<u.length;f++){var p=u[f];if(p.length==0)continue;c+=c.length>0?"%"+p:p}var d=c;if(c.length<=2)return;var h=b("autocompletaNomeFarmaco",[a,"text:"+d+"%"]);$.ajax({url:e,dataType:"jsonp",crossDomain:true,data:{sql:h,encoding:o.encoding}}).then(function(e){var a="|";$.each(e,function(e,r){var i=null;var t=r.split("|");if(t[0]=="A"||t[0]=="C"){i=t[1];if(a.indexOf("|"+i+"|")>=0)return;a+=i+"|";i='<span style="color: #007700;">'+i+"</span>"}else if(t[0]=="B"||t[0]=="D"){i=t[1].replace(/\(/gi,'<i style="font-size: smaller;">').replace(/\)/gi,"</i>");if(a.indexOf("|"+i+"|")>=0)return;a+=i+"|";i='<span style="color: #000077;">'+i+"</span>"}l+="<li><a href=\"javascript:OnClickAutocomplete('"+t[1]+"', '"+t[0]+"', '#autocomplete2')\">"+i+"</a></li>"});t.html(l);t.listview("refresh");t.trigger("updatelayout")})}else if(s&&s.length==0){m();$("#autocomplete1div").show();$("#autocomplete2div").show();$("#cerca0").html("")}});$.ajax({type:"GET",url:t,dataType:"xml",success:function(e){o.query=$(e)},error:function(){alert("Cannot load backend queries from XML.");return}});$("#search").on("pageshow",function(e){if(!$("#displaysearch").is(":visible")){$("#displaysearch").slideToggle("fast",function(){})}$("#search div .ui-input-search").each(function(e){$(this).css("font-size","16px");$(this).css("height","40px");$(this).css("border","4px solid #c0c0c0")});$("#search .ui-input-search").find("input").each(function(e){$(this).css("font-size","16px");$(this).css("height","100%");$(this).css("color","darkBLue")});$("#search .ui-input-clear").on("click",function(e){console.log("clear invoked...");for(var a=0;a<k.length;a++){k[a]=""}$("#cerca0").html("");$("#menuforma").hide();m();$("#autocomplete1div").show();$("#autocomplete2div").show();$("#menucerca").show()})});$(document).ajaxStart(function(){$("html, body").animate({scrollTop:0},400);$("#popupWait").popup("open",{allowSamePageTransition:true,transition:"pop"})}).ajaxStop(function(){$("html, body").animate({scrollTop:0},400);$("#popupWait").popup("close")});$(document).keydown(function(e){var a=false;var r=e.keyCode?e.keyCode:e.which;if(r=="8"){console.log(" **** backspace pressed");var i=e.srcElement||e.target;if(i.tagName.toUpperCase()==="INPUT"&&(i.type.toUpperCase()==="TEXT"||i.type.toUpperCase()==="PASSWORD"||i.type.toUpperCase()==="FILE"||i.type.toUpperCase()==="SEARCH"||i.type.toUpperCase()==="EMAIL"||i.type.toUpperCase()==="NUMBER"||i.type.toUpperCase()==="DATE")||i.tagName.toUpperCase()==="TEXTAREA"){a=i.readOnly||i.disabled}else{a=true}}else if(r=="9"){console.log(" **** tab pressed")}else if(r=="13"){console.log(" **** carriage return pressed")}if(a){e.preventDefault()}});$("#search").on("swiperight",function(){});$("#results").on("swiperight",function(){goback()})}function A(){for(var e=0;e<z.length;e++){if(z[e][1]>0)z[e][1]--}var a=0;for(a=k.length-1;a>0;a--){if(k[a]!=""){break}}k[a]="";a--;if(a>0){setPage(a,k[a],true)}else{goback()}}function goback(){if($("#cerca0").html().length==0)return;for(var e=0;e<k.length;e++){k[e]=""}setTimeout(function(){$("#menuforma").hide();$("#menucerca").hide();$.mobile.changePage("#search",{reverse:true,allowSamePageTransition:true,transition:"slide"});$("#cerca0").html("");m();$("#autocomplete1div").show();$("#autocomplete2div").show();$("#menucerca").slideToggle("slow",function(){})},200)}function y(){$("html, body").animate({scrollTop:0},400)}function M(){$("html, body").animate({scrollTop:320},400)}var app={initialize:function(){this.bindEvents();if(typeof cordova=="undefined"){this.onDeviceReady()}},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,false)},onDeviceReady:function(){document.addEventListener("hidekeyboard",y,false);document.addEventListener("showkeyboard",M,false);app.receivedEvent("deviceready");var e=document.getElementById("home1");var a=e.querySelector(".listening");var r=e.querySelector(".received");a.setAttribute("style","display:none;");r.setAttribute("style","display:block;");P()},receivedEvent:function(e){if(console){console.log("Received Event: "+e)}}};function w(a,r){if(!a||a.length==0){console.log("ERRORE: query non specificata in cercaTabellaOrdinataDosaggi()");return}if(!r||r.length==0){console.log("ERRORE: chiave di ricerca non specificata in cercaTabellaOrdinataDosaggi()");return}if(a=="tabellaOrdinataDosaggiPerNF"){r+="%"}$.ajax({url:e,dataType:"json",crossDomain:true,data:{sql:b(a,["text:"+r]),encoding:o.encoding},method:"POST",success:function(e){if(!e||e.length<=0){msgbox("Nessun farmaco autorizzato in<br/>classe A o C","Avviso",200);return}var a=null;var r=null;var i=null;var t=0;var n=false;z=[""];for(var o=0;o<e.length;o++){if(a!=e[o].aic||r!=e[o].id_par){t++;var s=C(e[o].forma);var l=parseInt(e[o].ups);n=true;z[t]=[e[o].aic,0,s,x(e[o]),l,l]}else{if(i==e[o].id_seq&&n){z[t][4]+=parseInt(e[o].ups)}else{n=false;var c=x(e[o]);if(c.length>0){if(z[t][3].length>0){z[t][3]+=" + "}z[t][3]+=c}}}a=e[o].aic;r=e[o].id_par;i=e[o].id_seq}stage=1;setPage(1,null)},error:function(e){console.log("remote error: "+JSON.stringify(e));msgbox("Impossibile collegarsi al backend","Avviso",500)}})}function L(e){var a=e.split(".");var r=a[0];var i=a[1];var t=i.length-1;while(t>=0){if(i[t]!="0")break;t--}if(t<0){return r}else{return r+","+i.substr(0,t+1)}}function N(e){if(!isNaN(e)||e.length<i)return e;return e.substr(0,i)+" ..."}function x(e){var a="";try{if(a.length==0&&e.pa_qta!=null){var r=e.pa_qta.replace(/\,/g,".");if(parseFloat(r)>0){a+=L(r);a+=" ";a+=e.pa_um}}if(a.length==0&&e.pa_perc!=null){var i=e.pa_perc.replace(/\,/g,".");if(parseFloat(i)>0){a+=L(i);a+=" ";a+="%"}}if(a.length==0&&e.pas_qta!=null){var r=e.pas_qta.replace(/\,/g,".");if(parseFloat(r)>0){a+=L(r);a+=" ";a+=e.pas_um}}if(a.length==0&&e.pas_perc!=null){var i=e.pas_perc.replace(/\,/g,".");if(parseFloat(i)>0){a+=L(i);a+=" ";a+="%"}}}catch(t){console.log("error: "+t+" - getDose() -> from "+JSON.stringify(e))}if(a.charAt(a.length-1)==",")a=a.substr(0,a.length-1);return a}var D=4;var z=[""];var k=["","","","","","",""];var U=null;var B=2;function setPage(e,a,r){k[e]=a;if(e>=D){var i="";var t=null;for(var n=1;n<z.length;n++){if(a&&e>1&&a!=z[n][e]){z[n][1]++}if(e>1&&z[n][1]>0)continue;var o=z[n][0];t=z[n][5];switch(B){case 2:if(i.length>0){i+=","}i+=o;break;case 1:if(i.length==0){i=o}break;case 0:i=o;break}}U=t;R(i);return}else{var s="";var l=[""];var c=0;var u="|";for(var n=1;n<z.length;n++){if(a&&e>1&&a!=z[n][e]){z[n][1]++}if(e>1&&z[n][1]>0)continue;var f=z[n][e+1];if(u.indexOf("|"+f+"|")>=0)continue;u+=f;u+="|";s+='<tr><td align="left">';s+='<a href="javascript: setPage('+(e+1)+", '"+f+"')\" ";s+='class="ui-corner-all ui-shadow ui-overlay-shadow ui-btn" ';s+='style="background: #11389D; color: white; font-weight: bolder; border-radius: 16px !important;">';s+='<span class="ui-btn-inner" style="vertical-align: middle;">';s+='<span class="ui-btn-text" style="font-size: 14px;">'+N(f)+"</span>";s+="</span>";s+="</a>";s+="</td></tr>";l[c++]=f}if(c<2){setPage(e+1,l[0]);return}}var p='<span style="font-size: 12px;">';for(var n=2;n<=e+1;n++){if(n>2)p+=" &gt; ";p+=k[n]}p+="</span><br/>";switch(e){case 1:p+="selezionare la tipologia";break;case 2:p+="selezionare il dosaggio";break;case 3:p+="selezionare unit&agrave; posologiche";break}$("#cerca0").html(p);$("#menucerca").hide();$("#menuforma").hide();$("#menuforma").html(s);var d=0;var h=[""];$("#menuforma tr").each(function(){var e=$(this);h[d++]=e.text()});h=h.sort(function(e,a){try{var r=e.replace(/\,/g,".").split(" ")[0].toLowerCase();var i=a.replace(/\,/g,".").split(" ")[0].toLowerCase();if(!isNaN(r)&&!isNaN(r)){return parseFloat(r)<parseFloat(i)?1:-1}else{r=e;i=a;for(var t=0;t<r.length&&t<i.length;t++){if(r.charCodeAt(t)<i.charCodeAt(t)){return 1}else if(r.charCodeAt(t)>i.charCodeAt(t)){return-1}}return r.length<i.length?1:-1}}catch(n){console.log("sort error => "+n)}return 0});for(var v=0;v<h.length;v++){$("#menuforma tr").each(function(){var e=$(this);if(e.text()!=h[v])return;e.insertBefore(e.parent().find("tr:first-child"))})}if(r){$.mobile.changePage("#search",{allowSamePageTransition:true,transition:"slide",reverse:true})}else{$.mobile.changePage("#search",{allowSamePageTransition:true,transition:"slide"})}$("#menuforma").fadeIn(1e3)}
