var list=null;var doc=null;function msgbox(a){$("#error").html(a);$("#displayerror").click()}function dosearch(){try{var a=$("#aic").val().trim();if(a.length==0)throw"Inserire il codice AIC";if(a.charAt(0)=="A")a=a.substr(1);if(a.charAt(0)=="a")a=a.substr(1);var e="";for(var i=0;i<a.length;i++){if("0123456789".indexOf(a.charAt(i))>=0)e+=a.charAt(i);else if(" .-\r\n	".indexOf(a.charAt(i))<0)throw"Codice AIC non valido<br />"+"Deve contenere solo caratteri numerici,<br />"+"puo' avere come carattere iniziale 'A'"}while(e.length<9){e="0"+e}$.ajax({url:"archive",dataType:"json",data:'{ "aic": "'+e+'" }',method:"post",success:function(a){try{if(!a&&a.length<=0)throw"codice AIC "+e+" non trovato";doc=null;list=a;for(var i=0;i<list.length;i++){if(list[i].isDefaultLanguage){doc=list[i];break}}if(!doc||doc==null)doc=list[0];$("#aic").val("");reload();$("#success").click()}catch(t){msgbox(t)}$("#loading-popup").hide()},error:function(a){$("#loading-popup").hide();msgbox("Codice AIC non trovato")}})}catch(t){$("#loading-popup").hide();msgbox(t)}}function getpageurl(a,e){var i=-1;var t=false;var o="png";var n="-sDEVICE=pngalpha "+"-dFirstPage="+e+" "+"-dLastPage="+e+" "+"-dMaxBitmap=500000000 "+"-dAlignToPixels=0 "+"-dGridFitTT=0 "+"-dTextAlphaBits=4 "+"-dGraphicsAlphaBits=4 "+"-r120x120";return"pages/"+a+"?page="+e+(i>0?"&timeout="+i:"")+(t?"&nocache=true":"")+"&gsext="+o+"&gsopts="+encodeURI(n)}function reload(){var a=0;$("img").each(function(){var e=$(this).attr("id");if(e==null)return;if(e.indexOf("page")<0)return;if(e.indexOf("file")<0)return;a++;if(a>doc.pagesCount){$(this).css("display","none");$("#page"+(a-1)+"footer").css("display","none")}else{$(this).attr("src",getpageurl(doc.filename,a));$(this).css("display","block");$("#page"+(a-1)+"footer").html("Pagina "+a+" di "+doc.pagesCount);$("#page"+(a-1)+"footer").css("display","block")}});for(var e=0;e<1;e++){$("#lang-it"+"-"+e).css("display","none");$("#lang-de"+"-"+e).css("display","none");$("#lang-en"+"-"+e).css("display","none");$("#lang-es"+"-"+e).css("display","none");$("#lang-fr"+"-"+e).css("display","none");for(var i=0;i<list.length;i++){var t=list[i].language.toLowerCase();try{$("#lang-"+t+"-"+e).css("display","block")}catch(o){}}}}function chlang(a){var e;for(e=0;e<30;e++){$("#page"+e+"file").attr("src","images/loading.gif")}for(e=0;e<list.length;e++){if(list[e].language.toLowerCase()==a){doc=list[e];break}}reload();if($.mobile.activePage.attr("id")=="page0"){$("html, body").animate({scrollTop:0},"slow")}else{$.mobile.changePage("#page0",{allowSamePageTransition:true,transition:"slide",reverse:true})}}function _onload(){$(document).ajaxStart(function(){$("#aic").hide();$("#loading").fadeIn()}).ajaxStop(function(){$("#loading").hide();$("#aic").show()});$("#aic").keypress(function(a){if(a&&a.which&&a.which==13){dosearch()}});if($("#aic").val().trim().length>0){dosearch()}}
