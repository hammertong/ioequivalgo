var list=null;var doc=null;function msgbox(a){$("#error").html(a);$("#displayerror").click()}function dosearch(a){try{var e=$("#aic").val().trim();if(e.length==0)throw"Inserire il codice AIC";if(e.charAt(0)=="A")e=e.substr(1);if(e.charAt(0)=="a")e=e.substr(1);var i="";for(var t=0;t<e.length;t++){if("0123456789".indexOf(e.charAt(t))>=0)i+=e.charAt(t);else if(" .-\r\n	".indexOf(e.charAt(t))<0)throw"Codice AIC non valido<br />"+"Deve contenere solo caratteri numerici,<br />"+"puo' avere come carattere iniziale 'A'"}while(i.length<9){i="0"+i}$.ajax({url:"archive",dataType:"json",data:'{ "aic": "'+i+'" }',method:"post",success:function(e){try{if(!e&&e.length<=0)throw"codice AIC "+i+" non trovato";doc=null;list=e;for(var t=0;t<list.length;t++){if(list[t].isDefaultLanguage){doc=list[t];break}}if(!doc||doc==null)doc=list[0];$("#aic").val("");reload(a);$("#success").click()}catch(o){msgbox(o)}$("#loading-popup").hide()},error:function(a){$("#loading-popup").hide();msgbox("Codice AIC non trovato")}})}catch(o){$("#loading-popup").hide();msgbox(o)}}function getpageurl(a,e){var i=-1;var t=false;var o="png";var n="-sDEVICE=pngalpha "+"-dFirstPage="+e+" "+"-dLastPage="+e+" "+"-dMaxBitmap=500000000 "+"-dAlignToPixels=0 "+"-dGridFitTT=0 "+"-dTextAlphaBits=4 "+"-dGraphicsAlphaBits=4 "+"-r120x120";return"pages/"+a+"?page="+e+(i>0?"&timeout="+i:"")+(t?"&nocache=true":"")+"&gsext="+o+"&gsopts="+encodeURI(n)}var swipe_off_flag=false;function swipe_off(){swipe_off_flag=true;setInterval("swipe_on()",500)}function swipe_on(){swipe_off_flag=false}function reload(a){var e=0;$("img").each(function(){var a=$(this).attr("id");if(a==null)return;if(a.indexOf("page")<0)return;if(a.indexOf("file")<0)return;e++;if(e>doc.pagesCount){$(this).attr("src","images/loading.gif")}else{$(this).attr("src",getpageurl(doc.filename,e))}});for(var i=0;i<a;i++){$("#lang-it"+"-"+i).css("display","none");$("#lang-de"+"-"+i).css("display","none");$("#lang-en"+"-"+i).css("display","none");$("#lang-es"+"-"+i).css("display","none");$("#lang-fr"+"-"+i).css("display","none");for(var t=0;t<list.length;t++){var o=list[t].language.toLowerCase();try{$("#lang-"+o+"-"+i).css("display","block")}catch(n){}}var r=-1;$("#page"+i+" a").each(function(){switch(r){case-1:$(this).attr("href","#page"+(i+r));break;case 1:$(this).attr("href",i<doc.pagesCount-1?"#page"+(i+r):"#");break}r++});$("#page"+i).on("pageshow",function(){})}}function chlang(a,e){var i;for(i=0;i<e;i++){$("#page"+i+"file").attr("src","images/loading.gif")}for(i=0;i<list.length;i++){if(list[i].language.toLowerCase()==a){doc=list[i];break}}reload(e);if($.mobile.activePage.attr("id")=="page0"){$("html, body").animate({scrollTop:0},"slow")}else{$.mobile.changePage("#page0",{allowSamePageTransition:true,transition:"slide",reverse:true})}}function _onload(a){$.mobile.changePage("#other-page",{allowSamePageTransition:true});var e=$("#loading").hide();var i=$("#searchbutton").fadeIn();for(var t=0;t<a;t++){(function(){var a=$("#focal"+t);var e=a.find(".panzoom").panzoom();e.parent().on("mousewheel.focal",function(a){a.preventDefault();var i=a.delta||a.originalEvent.wheelDelta;var t=i?i<0:a.originalEvent.deltaY>0;e.panzoom("zoom",t,{minScale:.9,increment:.3,animate:false,focal:a})})})()}$(document).ajaxStart(function(){i.hide();e.fadeIn()}).ajaxStop(function(){e.hide();i.show()});$("#aic").keypress(function(a){if(a&&a.which&&a.which==13){dosearch()}});if($("#aic").val().trim().length>0){dosearch()}}function xy(){var a="";a+=$("#focal0").width();a+=" x ";a+=$("#focal0").height();a+="\r\n";a+=$("#focal0").offset();alert(a)}
